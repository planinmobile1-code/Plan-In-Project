<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Countdown Dashboard</title>
<style>
body {
   font-family: Arial, sans-serif;
   padding: 20px;
   background: #f5f5f5;
}
.team-group {
   margin-top: 40px;
}
.team-title {
   font-size: 28px;
   font-weight: bold;
   padding: 10px 20px;
   border-radius: 8px;
   color: white;
   margin-bottom: 15px;
}
.project {
   background: white;
   padding: 18px 20px;
   margin: 10px auto;
   max-width: 800px;
   border-radius: 10px;
   box-shadow: 0 4px 12px rgba(0,0,0,0.08);
   transition: transform 0.2s;
}
.project:hover {
   transform: translateY(-3px);
   box-shadow: 0 6px 18px rgba(0,0,0,0.12);
}
.countdown {
   margin-top: 10px;
   font-size: 20px;
   font-weight: bold;
   color: #333;
}
</style>
</head>
<body>
<h1 style="text-align:center; margin-bottom:30px;">ðŸ“… Project Countdown Dashboard</h1>
<div id="container"></div>
<script>
const jsonURL =
"https://docs.google.com/spreadsheets/d/1_jNi6ukRJRNwNrzikG-gIZnPSjGHPpDs_ckDSy9pBNA/gviz/tq?tqx=out:json";
/* Team â†’ Director & Color Map */
const TEAM_INFO = {
   "PD1": { director: "Wai Leung", color: "#1E88E5" },
   "PD2": { director: "Harley Lau", color: "#43A047" },
   "PD3": { director: "Sherman Choi", color: "#F4511E" }
};
/* Load Google Sheet JSON */
async function loadProjects() {
   try {
       const res = await fetch(jsonURL);
       let text = await res.text();
       const start = text.indexOf("{");
       const end = text.lastIndexOf("}") + 1;
       const cleanText = text.substring(start, end);
       const json = JSON.parse(cleanText);
       const rows = json.table.rows;
       const projects = rows.map(r => ({
           name: r.c[0]?.v || "",
           team: r.c[1]?.v || "",
           deadlineText: r.c[3]?.v || "",
           manager: r.c[4]?.v || "",
           sec: r.c[5]?.v || ""
       }));
       renderGrouped(projects);
   } catch (err) {
       console.error("JSON load error:", err);
   }
}
/* Group and render by fixed Team order */
function renderGrouped(list) {
   const container = document.getElementById("container");
   container.innerHTML = "";
   const fixedOrder = ["PD1", "PD2", "PD3"];
   fixedOrder.forEach(team => {
       const teamProjects = list.filter(p => p.team === team);
       if (teamProjects.length === 0) return;
       const groupDiv = document.createElement("div");
       groupDiv.className = "team-group";
       const info = TEAM_INFO[team] || {};
       const color = info.color || "#333";
       const director = info.director || "";
       groupDiv.innerHTML = `
<div class="team-title" style="background-color:${color};">${team} â€“ ${director}</div>
       `;
       teamProjects.forEach((p, i) => {
           const card = document.createElement("div");
           card.className = "project";
           card.innerHTML = `
<h2>${p.name}</h2>
<p><b>Project Manager:</b> ${p.manager}</p>
<p><b>Project Secretary:</b> ${p.sec}</p>
<div class="countdown" id="${team}_cd${i}"></div>
           `;
           groupDiv.appendChild(card);
           createCountdown(p.deadlineText, `${team}_cd${i}`);
       });
       container.appendChild(groupDiv);
   });
}
/* Countdown Timer */
function createCountdown(dltxt, id) {
   const target = new Date(dltxt.replace(" ", "T"));
   function tick() {
       const el = document.getElementById(id);
       if (!el) return;
       const now = new Date();
       const diff = target - now;
       if (diff <= 0) {
           el.textContent = "ðŸŽ‰ Completed!";
           return;
       }
       const d = Math.floor(diff / (1000 * 60 * 60 * 24));
       const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
       const m = Math.floor((diff / (1000 * 60)) % 60);
       const s = Math.floor((diff / 1000) % 60);
       el.textContent = `${d} Days ${h} Hours ${m} Minutes ${s} Seconds`;
   }
   tick();
   setInterval(tick, 1000);
}
loadProjects();
</script>
</body>
</html>