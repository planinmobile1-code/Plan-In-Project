<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Debug Google Sheet</title>
</head>
<body>
<h1>Google Sheet Debug</h1>
<pre id="output">Loading...</pre>
<script>
const jsonURL =
"https://docs.google.com/spreadsheets/d/1_jNi6ukRJRNwNrzikG-gIZnPSjGHPpDs_ckDSy9pBNA/gviz/tq?tqx=out:json&gid=0";
async function test() {
 try {
   const res = await fetch(jsonURL);
   const text = await res.text();
   // 顯示原始回應頭 300 字
   console.log("RAW:", text.slice(0, 300));
   const start = text.indexOf("{");
   const end = text.lastIndexOf("}") + 1;
   if (start === -1 || end === -1) {
     document.getElementById("output").textContent =
       "❌ 找不到 JSON {} 結構";
     return;
   }
   const json = JSON.parse(text.substring(start, end));
   if (!json.table || !json.table.rows) {
     document.getElementById("output").textContent =
       "❌ json.table.rows 不存在\n\n" +
       JSON.stringify(json, null, 2);
     return;
   }
   document.getElementById("output").textContent =
     "✅ 成功讀到 rows: " + json.table.rows.length + "\n\n" +
     JSON.stringify(json.table.rows, null, 2);
 } catch (e) {
   document.getElementById("output").textContent =
     "❌ Error:\n" + e;
 }
}
test();
</script>
</body>
</html>