<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Countdown Board</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 40px;
  }
  h1 {
    text-align: center;
  }
  .project {
    border: 1px solid #ccc;
    padding: 20px;
    margin: 20px auto;
    width: 800px;
    border-radius: 8px;
    box-shadow: 0 0 8px #eee;
    text-align: center;
  }
  .countdown {
    font-size: 24px;
    font-weight: bold;
    margin-top: 10px;
    text-align: center;
  }
  /* Add Project Box */
  #addBox {
    width: 800px;
    margin: 20px auto;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
  }
  input, button {
    padding: 8px;
    margin: 5px 0;
    width: 100%;
    font-size: 16px;
  }
</style>
</head>
<body>
<h1>üìÖ Project Countdown Dashboard</h1>
<!-- Add Project UI -->
<div id="addBox">
<h3>‚ûï Êñ∞Â¢û Project</h3>
<input id="pName" type="text" placeholder="Project ÂêçÁ®±">
<input id="pDeadline" type="datetime-local">
<button onclick="addProject()">Âä†ÂÖ• Project</button>
</div>
<!-- Countdown container -->
<div id="container"></div>
<script>
// ---------------------------
// 1Ô∏è‚É£ Load projects (JSON ‚Üí localStorage)
// ---------------------------
async function loadProjects() {
 // Always reload JSON first (ÈÅøÂÖç localStorage Èòª‰Ωè‰Ω†Ôºâ
 let projects;
 try {
   const response = await fetch("./projects.json?v=" + Date.now());
   projects = await response.json();
 } catch (err) {
   console.warn("‚ö† ÁÑ°Ê≥ïËÆÄÂèñ projects.jsonÔºå‰ΩøÁî®Á©∫Èô£Âàó", err);
   projects = [];
 }
 // Save into localStorage
 localStorage.setItem("projects", JSON.stringify(projects));
 // Render
 renderProjects(projects);
}
// ---------------------------
// 2Ô∏è‚É£ Render Project List
// ---------------------------
function renderProjects(projects) {
 const container = document.getElementById("container");
 container.innerHTML = "";
 projects.forEach((proj, index) => {
   const div = document.createElement("div");
   div.className = "project";
   div.innerHTML = `
<h2>${proj.name}</h2>
<div class="countdown" id="cd${index}"></div>
   `;
   container.appendChild(div);
   createCountdown(proj.deadline, `cd${index}`);
 });
}
// ---------------------------
// 3Ô∏è‚É£ Add Project
// ---------------------------
function addProject() {
 const name = document.getElementById("pName").value.trim();
 const deadline = document.getElementById("pDeadline").value; // yyyy-MM-ddTHH:mm
 if (!name || !deadline) {
   alert("Ë´ãËº∏ÂÖ• Project ÂêçÁ®±Âíå Deadline");
   return;
 }
 // datetime-local Ê≤íÊúâÁßí ‚Üí Ëá™ÂãïË£ú‰∏ä
 const finalDeadline = deadline.length === 16 ? deadline + ":00" : deadline;
 const projects = JSON.parse(localStorage.getItem("projects")) || [];
 projects.push({
   name: name,
   deadline: finalDeadline
 });
 localStorage.setItem("projects", JSON.stringify(projects));
 renderProjects(projects);
 document.getElementById("pName").value = "";
 document.getElementById("pDeadline").value = "";
}
// ---------------------------
// 4Ô∏è‚É£ Countdown function
// ---------------------------
function createCountdown(deadline, elementId) {
 const targetDate = new Date(deadline);
 function update() {
   const now = new Date();
   const diff = targetDate - now;
   const el = document.getElementById(elementId);
   if (diff <= 0) {
     el.innerHTML = "üéâ Completed!";
     return;
   }
   const d = Math.floor(diff / (1000 * 60 * 60 * 24));
   const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
   const m = Math.floor((diff / (1000 * 60)) % 60);
   const s = Math.floor((diff / 1000) % 60);
   el.innerHTML = `${d} Days ${h} Hours ${m} Minutes ${s} Seconds`;
 }
 update();
 setInterval(update, 1000);
}
loadProjects();
</script>
</body>
</html>