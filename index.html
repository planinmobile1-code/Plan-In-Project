<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Countdown Dashboard</title>
<style>
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: #f5f7fa;
  color: #333;
}
h1 {
  text-align: center;
  margin-top: 40px;
  font-size: 36px;
  color: #1f3c88;
}
#container {
  max-width: 900px;
  margin: 20px auto 60px auto;
}

/* Project Âç°Áâá */
.project {
  background: linear-gradient(135deg, #ffffff 0%, #e9f0ff 100%);
  border-radius: 12px;
  padding: 20px;
  margin: 20px auto;
  width: 900px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  text-align: center;
  transition: transform 0.2s;
}
.project:hover {
  transform: translateY(-4px);
}
.project h2 {
  margin: 0;
  color: #1f3c88;
}
.countdown {
  font-size: 22px;
  font-weight: bold;
  margin-top: 10px;
}
</style>
</head>
<body>

<h1>üìÖ Project Countdown Dashboard</h1>
<div id="container"></div>

<script>
// ‰Ω†ÁöÑ pubhtml Á∂≤ÂùÄ
const sheetURL = "https://docs.google.com/spreadsheets/u/2/d/e/2PACX-1vSDMRhc5hutkg0TtjTLrI2U7u8o9LqJWzGMHa9ksbWub6oMI9q4cDmpz77Jgf8q6flM1hJfZ2rQlBxv/pubhtml";

async function loadProjects() {
  try {
    const res = await fetch(sheetURL);
    const text = await res.text();

    // Âæû HTML ‰∏≠ÊäìÂá∫ table
    const parser = new DOMParser();
    const doc = parser.parseFromString(text, "text/html");
    const table = doc.querySelector("table");
    if (!table) {
      console.error("Êú™ÊâæÂà∞Ë°®Ê†º");
      return;
    }

    const rows = Array.from(table.querySelectorAll("tr")).slice(1); // Ë∑≥ÈÅéÊ®ôÈ°åÂàó
    const projects = rows.map(row => {
      const cells = row.querySelectorAll("td");
      return {
        name: cells[0]?.innerText.trim() || "",
        deadline: cells[1]?.innerText.trim() || ""
      };
    });

    renderProjects(projects);
  } catch (e) {
    console.error("ËÆÄÂèñ Google Sheet Â§±Êïó", e);
  }
}

function renderProjects(projects) {
  const container = document.getElementById("container");
  container.innerHTML = "";
  projects.forEach((proj, index) => {
    const div = document.createElement("div");
    div.className = "project";
    div.innerHTML = `
      <h2>${proj.name}</h2>
      <div class="countdown" id="cd${index}"></div>
    `;
    container.appendChild(div);
    createCountdown(proj.deadline, cd${index});
  });
}

function createCountdown(deadline, elementId) {
  const targetDate = new Date(deadline);

  function update() {
    const now = new Date();
    const diff = targetDate - now;
    const el = document.getElementById(elementId);
    if (!el) return;
    if (diff <= 0) { el.innerHTML = "üéâ Completed!"; return; }

    const d = Math.floor(diff / (1000*60*60*24));
    const h = Math.floor((diff / (1000*60*60)) % 24);
    const m = Math.floor((diff / (1000*60)) % 60);
    const s = Math.floor((diff/1000)%60);
    el.innerHTML = ${d} Days ${h} Hours ${m} Minutes ${s} Seconds;
  }

  update();
  setInterval(update, 1000);
}

// ÂàùÂßãÂåñ
loadProjects();
</script>
</body>
</html>