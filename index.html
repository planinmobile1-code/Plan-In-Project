<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Countdown Dashboard</title>
<style>
body { font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:0; background:#f5f7fa; color:#333; }
h1 { text-align:center; margin-top:40px; font-size:36px; color:#1f3c88; }
#container { max-width:900px; margin:20px auto 60px auto; }
.project { background:linear-gradient(135deg,#ffffff 0%,#e9f0ff 100%); border-radius:12px; padding:20px; margin:20px auto; width:900px; box-shadow:0 6px 20px rgba(0,0,0,0.08); text-align:center; transition: transform 0.2s; }
.project:hover { transform:translateY(-4px); }
.project h2 { margin:0; color:#1f3c88; }
.project p { margin:5px 0; font-weight:500; color:#555; }
.countdown { font-size:22px; font-weight:bold; margin-top:10px; }
</style>
</head>
<body>
<h1>ðŸ“… Project Countdown Dashboard</h1>
<div id="container"></div>
<script>
// JSON Feed URL
const jsonURL = "https://docs.google.com/spreadsheets/d/1_jNi6ukRJRNwNrzikG-gIZnPSjGHPpDs_ckDSy9pBNA/gviz/tq?tqx=out:json&gid=0";
// è§£æž Google Sheet JSON Feed
async function loadProjects() {
 try {
   const res = await fetch(jsonURL);
   let text = await res.text();
   // åŽ»æŽ‰ google.visualization.Query.setResponse åŒ…è£
   const json = JSON.parse(text.substr(47).slice(0, -2));
   const rows = json.table.rows;
   const projects = rows.map(r => ({
     name: r.c[0] ? r.c[0].v : "",
     // Deadline è‡ªå‹•æ ¼å¼åŒ–ï¼šç©ºæ ¼æ› T
     deadline: r.c[1] ? r.c[1].v.replace(" ","T") : "",
     manager: r.c[2] ? r.c[2].v : "",
     sec: r.c[3] ? r.c[3].v : ""
   }));
   renderProjects(projects);
 } catch(e) {
   console.error("æŠ“å– JSON å¤±æ•—:", e);
 }
}
// æ¸²æŸ“å°ˆæ¡ˆ
function renderProjects(projects){
 const container = document.getElementById("container");
 container.innerHTML = "";
 projects.forEach((proj,index)=>{
   const div = document.createElement("div");
   div.className="project";
   div.innerHTML=`
<h2>${proj.name}</h2>
<p><strong>Project Manager:</strong> ${proj.manager}</p>
<p><strong>Project Sec:</strong> ${proj.sec}</p>
<div class="countdown" id="cd${index}"></div>
   `;
   container.appendChild(div);
   createCountdown(proj.deadline,`cd${index}`);
 });
}
// å€’æ•¸å‡½æ•¸
function createCountdown(deadline,elementId){
 const targetDate = new Date(deadline);
 function update(){
   const now = new Date();
   const diff = targetDate - now;
   const el = document.getElementById(elementId);
   if(!el) return;
   if(diff<=0){ el.innerHTML="ðŸŽ‰ Completed!"; return; }
   const d=Math.floor(diff/(1000*60*60*24));
   const h=Math.floor((diff/(1000*60*60))%24);
   const m=Math.floor((diff/(1000*60))%60);
   const s=Math.floor((diff/1000)%60);
   el.innerHTML=`${d} Days ${h} Hours ${m} Minutes ${s} Seconds`;
 }
 update();
 setInterval(update,1000);
}
// åˆå§‹åŒ–
loadProjects();
</script>
</body>
</html>