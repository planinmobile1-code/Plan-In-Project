<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Countdown Board</title>
<style>
   body {
     font-family: Arial, sans-serif;
     margin: 40px;
   }
   h1 {
     text-align: center;
   }
   .project {
     border: 1px solid #ccc;
     padding: 20px;
     margin: 20px auto;
     width: 800px;
     border-radius: 8px;
     box-shadow: 0 0 8px #eee;
     text-align: center;
   }
   .countdown {
     font-size: 24px;
     font-weight: bold;
     margin-top: 10px;
     text-align: center;
   }
   /* æ–°å¢æŒ‰éˆ•å€ */
   #addBox {
     width: 800px;
     margin: 20px auto;
     padding: 20px;
     border: 1px solid #ddd;
     border-radius: 8px;
   }
   input, button {
     padding: 8px;
     margin: 5px 0;
     width: 100%;
     font-size: 16px;
   }
</style>
</head>
<body>

<h1>ğŸ“… Project Countdown Dashboard</h1>

<!-- ğŸ”½ ç”¨æˆ¶æ–°å¢ Project UI -->
<div id="addBox">
  <h3>â• æ–°å¢ Project</h3>
  <input id="pName" type="text" placeholder="Project åç¨±">
  <input id="pDeadline" type="datetime-local">
  <button onclick="addProject()">åŠ å…¥ Project</button>
</div>

<!-- ğŸ”½ Countdown é¡¯ç¤ºå€ -->
<div id="container"></div>

<script>

// ---------------------------
// 1ï¸âƒ£ è®€å– Project è³‡æ–™ï¼ˆLocalStorage å„ªå…ˆï¼‰
// ---------------------------
async function loadProjects() {
  let projects = JSON.parse(localStorage.getItem("projects"));

  if (!projects) {
    // å¦‚æœ localStorage å†‡ï¼Œå…ˆç”¨ä½  GitHub json åˆå§‹å€¼
    const response = await fetch("projects.json?v=" + Date.now());
    projects = await response.json();
    localStorage.setItem("projects", JSON.stringify(projects));
  }

  renderProjects(projects);
}

// ---------------------------
// 2ï¸âƒ£ é¡¯ç¤ºæ‰€æœ‰å€’æ•¸è¨ˆæ™‚
// ---------------------------
function renderProjects(projects) {
  const container = document.getElementById("container");
  container.innerHTML = ""; // æ¸…ç©º

  projects.forEach((proj, index) => {
    const div = document.createElement("div");
    div.className = "project";
    div.innerHTML = `
      <h2>${proj.name}</h2>
      <div class="countdown" id="cd${index}"></div>
    `;
    container.appendChild(div);
    createCountdown(proj.deadline, cd${index});
  });
}

// ---------------------------
// 3ï¸âƒ£ æ–°å¢ Project
// ---------------------------
function addProject() {
  const name = document.getElementById("pName").value.trim();
  const deadline = document.getElementById("pDeadline").value;

  if (!name || !deadline) {
    alert("è«‹è¼¸å…¥ Project åç¨±å’Œ Deadline");
    return;
  }

  const projects = JSON.parse(localStorage.getItem("projects")) || [];

  projects.push({
    name: name,
    deadline: deadline
  });

  localStorage.setItem("projects", JSON.stringify(projects));

  // UI refresh
  renderProjects(projects);

  // æ¸…ç©ºè¼¸å…¥æ ¼
  document.getElementById("pName").value = "";
  document.getElementById("pDeadline").value = "";
}

// ---------------------------
// 4ï¸âƒ£ å€’æ•¸è¨ˆæ™‚ Function
// ---------------------------
function createCountdown(deadline, elementId) {
  const targetDate = new Date(deadline);
  function update() {
    const now = new Date();
    const diff = targetDate - now;
    const el = document.getElementById(elementId);
    if (diff <= 0) {
      el.innerHTML = "ğŸ‰ Completed!";
      return;
    }
    const d = Math.floor(diff / (1000 * 60 * 60 * 24));
    const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const m = Math.floor((diff / (1000 * 60)) % 60);
    const s = Math.floor((diff / 1000) % 60);
    el.innerHTML = ${d} Days ${h} Hours ${m} Minutes ${s} Seconds;
  }
  update();
  setInterval(update, 1000);
}

loadProjects();

</script>
</body>
</html>